service: app
image: app
servers:
  - vm1
  - vm2: [ tag1, tag2 ]
env:
  clear:
    CLEAR_TOKEN: 4321
    CLEAR_TAG: ""
    HOST_TOKEN: "${HOST_TOKEN}"
  secret:
    - SECRET_TOKEN
  tags:
    tag1:
      CLEAR_TAG: tagged
    tag2:
      secret:
        - SECRET_TAG
asset_path: /usr/share/nginx/html/versions

registry:
  server: registry:4443
  username: root
  password: root
builder:
  multiarch: false
  args:
    COMMIT_SHA: <%= `git rev-parse HEAD` %>
proxy:
  image: registry:4443/basecamp/parachute:latest
  http_port: 80
  https_port: 443
  debug: true
accessories:
  busybox:
    service: custom-busybox
    image: registry:4443/busybox:1.36.0
    cmd: sh -c 'echo "Starting busybox..."; trap exit term; while true; do sleep 1; done'
    roles:
      - web
stop_wait_time: 1
readiness_delay: 0
